# 网络设备发现与信息同步工具

## 介绍

该工具是一款网络设备管理实用程序，主要功能包括：

- 自动扫描当前子网内的所有活跃设备，获取其IP地址和MAC地址
- 检测本地设备上所有处于监听状态的程序及其端口
- 定期将发现的设备信息通过HTTP POST请求同步到本地监听程序的`/__gnip__`端点

工具采用多线程设计，能够高效地进行网络扫描和信息同步，适用于需要实时获取局域网设备信息的场景，可帮助开发人员快速构建基于局域网设备发现的应用系统。

## 安装

### 环境要求
- Python 3.6 及以上版本
- 支持Windows、Linux和macOS操作系统

### 依赖安装
1. 克隆或下载代码库到本地
2. 安装所需依赖库：
```bash
pip install psutil netifaces requests
```

## 部署

### 本地部署
1. 将代码库文件放置在本地目录，确保包含以下文件：
   - main.py（主程序入口）
   - gnip.py（IP地址计算工具）
   - file.py（网络工具函数）

2. 直接运行主程序：
```bash
python main.py
```

程序启动后将自动在后台运行，无需额外配置，默认执行以下操作：
- 扫描当前子网内的设备（最多512个IP地址），IP地址扫描顺序以本机IP为基准，按照网络地址规则排序，确保从与本机IP最接近的地址开始扫描，逐步扩展至整个子网范围
- 检测本地所有监听端口的程序
- 每1秒向有效程序同步一次设备信息

### 被同步程序要求
需要接收设备信息的本地程序需满足：
1. 处于监听状态，可通过本地端口访问
2. 提供`/__gnip__`端点，支持POST请求
3. 对验证请求（`{"type": false}`）返回`{"message": 200}`
4. 对设备信息请求（`{"type": true, "device_list": [...]}`）返回`{"message": 200}`

### 注意事项
- 建议为程序设置开机自动启动
- 程序需要足够的权限执行网络扫描（如ICMP Ping操作）
- 防火墙设置可能影响设备发现和信息同步功能，必要时需配置防火墙规则
- 在大型网络环境中，可能需要调整代码中的扫描参数以优化性能
- 512个IP地址的扫描范围以本机IP为核心进行排序
